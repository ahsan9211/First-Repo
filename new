newer code to merge with master
